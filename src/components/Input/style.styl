@import '../../css/config'
@import '../../css/mixins'

//
// Variables
//
--label-margin-bottom := 0.5rem

--input-line-height := --line-height

--input-padding-sm := --spacers['1/2'] * --size-percentages['sm'] --spacers['1'] * --size-percentages['sm']
--input-padding-md := --spacers['1/2'] --spacers['1']
--input-padding-lg := --spacers['1/2'] * --size-percentages['lg'] --spacers['1'] * --size-percentages['lg']
--input-padding := {
    'sm': --input-padding-sm
    'md': --input-padding-md
    'lg': --input-padding-lg
}

--input-prefix-padding-sm := --input-padding-sm[1] + --input-padding-sm[1] * 3
--input-prefix-padding-md := --input-padding-md[1] + --input-padding-md[1] * 3
--input-prefix-padding-lg := --input-padding-lg[1] + --input-padding-lg[1] * 3
--input-prefix-padding := {
    'sm': --input-prefix-padding-sm
    'md': --input-prefix-padding-md
    'lg': --input-prefix-padding-lg
}

--input-font-size := --font-size

--input-color := --colors['gray-70']
--input-color-focus := --input-color
--input-placeholder-color := --colors['gray-60']
--input-plaintext-color := --body-color
--input-background := --colors['white']
--input-background-disabled := --colors['gray-20']
--input-background-focus := --input-background

--input-border-width := --border-width
--input-border-color := --border-color
--input-border-color-focus := darken(--input-border-color, 10%)
--input-border-radius := --border-radius

--input-box-shadow := inset 0 1px 1px rgba(--colors['black'], 0.05)
--input-transition := border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out

--input-icon-circle-size := 1.2rem
--input-icon-circle-background := --colors['gray-40']
--input-icon-circle-background-hover := --colors['gray-50']

--input-append-prepend-background-color := --colors['gray-30']
--input-append-prepend-background-gradient := --gradients['gray-30']

//
// Mixins
//
-form-input-selector()
    > input
    > select
    > textarea
        {block}

-form-input-label-size(size)
    font-size: --input-font-size[size]

    &.-left
        padding-right: --input-padding[size][0] * 2

    &.-right
        padding-left: --input-padding[size][0] * 2

-form-input-size(size)
    +-form-input-selector()
        padding: --input-padding[size]
        font-size: --input-font-size[size]

        if --border-radius-enabled
            border-radius: --input-border-radius[size]

    &.-prefixed
        +-form-input-selector()
            padding-left: --input-prefix-padding[size]

    &.-suffixed
        +-form-input-selector()
            padding-right: --input-prefix-padding[size]

//
// Styles
//
.form-input
    position: relative
    display: flex
    flex: 1 0 auto
    flex-direction: row

    +-form-input-selector()
        position: relative
        display: flex
        flex: 1 0 auto
        width: 1%
        padding: --input-padding-md
        line-height: --input-line-height
        color: --input-color
        background-color: --input-background
        background-clip: padding-box
        border: --input-border-width solid --input-border-color

        box-shadow: --input-box-shadow
        if --transition['input']
            transition: --input-transition

        // Remove style for the caret on `<select>`s in IE10+.
        &::-ms-expand
            background-color: transparent
            border: 0

        // Customize the `:focus` state to imitate native WebKit styles.
        &:focus
            color: --input-color-focus
            background-color: --input-background-focus
            border-color: --input-border-color-focus
            outline: 0

            // Avoid using mixin so we can pass custom focus shadow properly
            if --box-shadow-enabled
                box-shadow: --input-box-shadow, --input-box-shadow-focus

        // Placeholder
        // Override Firefox's unusual default opacity see https://github.com/twbs/bootstrap/pull/11526.
        &::placeholder
            color: --input-placeholder-color
            opacity: 1

        // Disabled and read-only inputs
        //
        // HTML5 says that controls under a fieldset > legend:first-child won't be
        // disabled if the fieldset is disabled. Due to implementation difficulty, we
        // don't honor that edge case we style them as disabled anyway.
        &:disabled,
        &[readonly]
            background-color: --input-background-disabled
            opacity: 1  // iOS fix for unreadable disabled content


    .form-input-prefix
    .form-input-suffix
        z-index: 1
        top: 50%
        position: absolute
        transform: translateY(-50%)
        font-style: normal

    .form-input-prefix
        left: --spacer
        padding-right: --spacer
        border-right: 1px solid --input-border-color

    .form-input-suffix
        right: --spacer
        padding-left: --spacer
        border-left: 1px solid --input-border-color

    .form-input-icon
        transition: background-color --transition-duration --transition-easing
        color: --text-muted

        &.-circle
            display: inline-block
            text-align: center
            font-weight: bold
            cursor: pointer
            width: --input-icon-circle-size
            height: --input-icon-circle-size
            line-height: 1
            background-color: --input-icon-circle-background
            color: --input-background
            border-radius: 100%

            &:hover
                background-color: --input-icon-circle-background-hover

.form-input-prepend
.form-input-append
    display: flex
    padding: 0
    line-height: --input-line-height
    background-color: --input-append-prepend-background-color
    background-image: -linear-gradient(--input-append-prepend-background-gradient)

.form-input-label
    flex-basis: 100%

    &.-left
    &.-right
        display: flex
        flex: 0 0 auto
        align-self: center
        margin-bottom: 0

    &.-right
        order: 1

//
// Form input and input group sizes
//
for size in (sm md lg)
    .form-input-label.-{size}
        -form-input-label-size(size)

    .form-input.-{size}
        -form-input-size(size)


.form-input-label
    @extend .form-input-label.-md

.form-input
    @extend .form-input.-md
